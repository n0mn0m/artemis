steps:
  - script: |
      set -e
      curl https://sh.rustup.rs -sSf | sh -s -- -y --profile minimal --default-toolchain $RUSTUP_TOOLCHAIN
      echo "##vso[task.setvariable variable=PATH;]$PATH:$HOME/.cargo/bin"
    displayName: "Install rust (*nix)"
    condition: not(eq(variables['Agent.OS'], 'Windows_NT'))

  - script: |
      rustup component add rustfmt
    displayName: 'Install formatter'

  - script: |
      cargo install -v cargo-make
    displayName: 'Install cargo make'

  - script: |
      cargo make tool-ci
    displayName: 'Install ci tools'
